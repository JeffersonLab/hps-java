# include trigger/HPS/small/ssp/trigger/feemaskA.cnf

# SSP_HPS_SINGLES_PRESCALE N REGION XMIN XMAX PRESCALE
# #    N:        0 or 1 - selects the hps singles trigger bit
# #    REGION:   0 to 6 - selects which region index to define
# #    XMIN:    -31 to 31  - chooses the ECAL x coordinate to start region definition (inclusive)
# #    XMAX:    -31 to 31  - chooses the ECAL x coordinate to end region definition  (inclusive)
# #    PRESCALE: 0 to 65535 - set the prescale value for the region

SSP_CRATE hps11
SSP_ALLSLOTS
SSP_HPS_SINGLES_PRESCALE 1 0 -30 -13 0
SSP_HPS_SINGLES_PRESCALE 1 1 -12  -9 80
SSP_HPS_SINGLES_PRESCALE 1 2  -8  -7 1300
SSP_HPS_SINGLES_PRESCALE 1 3  -6  -3 18000
SSP_HPS_SINGLES_PRESCALE 1 4  -2   1 1300
SSP_HPS_SINGLES_PRESCALE 1 5   2   5 80
SSP_HPS_SINGLES_PRESCALE 1 6   6  30 0
SSP_CRATE end



##########################
# GTP
##########################
GTP_CRATE all

GTP_CLUSTER_PULSE_COIN      4    4

# SEED thrershold in MeV (0-8191)
GTP_CLUSTER_PULSE_THRESHOLD 100

GTP_CRATE end

##########################
# HPS 11 Crate
##########################

### TI
TI_CRATE hps11

TI_FIBER_DELAY_OFFSET 0x80 0xcf
TI_BUFFER_LEVEL 5
TI_BLOCK_LEVEL  10

## HOLD OFF
# 1.44 us holdoff:
#TI_HOLDOFF 1 3 1
TI_HOLDOFF 1 6 1

# 4 triggers in 10*3840ns
#TI_HOLDOFF 4 10 1
#TI_HOLDOFF 4 15 1
TI_HOLDOFF 4 20 1


# PRESCALE-FACTOR = 2

# SINGLES-0:
TI_INPUT_PRESCALE 1  13

# SINGLES-1:
TI_INPUT_PRESCALE 2  1

# PAIRS-0:
TI_INPUT_PRESCALE 3  6

# PAIRS-1:
TI_INPUT_PRESCALE 4  0

# COSMIC/LED:
TI_INPUT_PRESCALE 5  0

# PULSER:
TI_INPUT_PRESCALE 6  0

TI_CRATE end


### SSP
SSP_CRATE hps11

SSP_ALLSLOTS
SSP_W_WIDTH   50
SSP_W_OFFSET  753

# COSMIC:
#SSP_W_WIDTH   100
#SSP_W_OFFSET  799

SSP_HPS_PULSER 1000       # pulser period (s)

# ecal triggers:
# HPS SINGLES 0  -> TI TS1
SSP_HPS_SET_IO_SRC		7	20	#ENABLED
#SSP_HPS_SET_IO_SRC		7	0	#DISABLED

#HPS SINGLES 1   -> TI TS2
SSP_HPS_SET_IO_SRC		8	21	#ENABLED
#SSP_HPS_SET_IO_SRC		8	0	#DISABLED

#HPS PAIRS 0     -> TI TS3
SSP_HPS_SET_IO_SRC		9	22	#ENABLED
#SSP_HPS_SET_IO_SRC		9	0	#DISABLED

#HPS PAIRS 1     -> TI TS4
SSP_HPS_SET_IO_SRC		10	23	#ENABLED
#SSP_HPS_SET_IO_SRC		10	0	#DISABLED

# HPS COSMIC/LED -> TI TS5
#SSP_HPS_SET_IO_SRC		11	24	#ENABLED-LED
#SSP_HPS_SET_IO_SRC		11	25	#ENABLED-COSMIC
SSP_HPS_SET_IO_SRC		11	0	#DISABLED

# PULSER         -> TI TS6
SSP_HPS_SET_IO_SRC		12	18	#ENABLED
#SSP_HPS_SET_IO_SRC		12	0	#DISABLED


# coinc time 10=40 ns
SSP_HPS_COSMIC_TIMECOINCIDENCE  10

# cosmic B0 and B1 (136<<8) + led trigger (254<<0)
SSP_HPS_COSMIC_PATTERNCOINCIDENCE   35070

SSP_HPS_LATENCY 475

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  0  100  1
SSP_HPS_SINGLES_EMAX  0  2700 1
SSP_HPS_SINGLES_NMIN  0  3    1

# Singles 1 trigger
SSP_HPS_SINGLES_EMIN  1  1300  1
SSP_HPS_SINGLES_EMAX  1  2600 1
SSP_HPS_SINGLES_NMIN  1  3    1

# Pairs 0 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  0  2
SSP_HPS_PAIRS_EMIN             0  150
SSP_HPS_PAIRS_EMAX             0  1400
SSP_HPS_PAIRS_NMIN             0  2
SSP_HPS_PAIRS_SUMMAX_MIN       0  1900 500 1
SSP_HPS_PAIRS_DIFFMAX          0  1100     1
SSP_HPS_PAIRS_COPLANARITY      0  180      1
SSP_HPS_PAIRS_ENERGYDIST       0  5.5  400 1

# Pairs 1 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  1  3
SSP_HPS_PAIRS_EMIN             1  150
SSP_HPS_PAIRS_EMAX             1  1400
SSP_HPS_PAIRS_NMIN             1  2
SSP_HPS_PAIRS_SUMMAX_MIN       1  2000 600  1
SSP_HPS_PAIRS_DIFFMAX          1  1100      1
SSP_HPS_PAIRS_COPLANARITY      1  40        1
SSP_HPS_PAIRS_ENERGYDIST       1  5.5   600 1

SSP_CRATE end


### FADC: RF SIGNALS, HPS11, SLOT 13, CHANNELS 0/1
FADC250_CRATE hps11

FADC250_DAC  3300
FADC250_W_OFFSET 3012
FADC250_W_WIDTH 400

FADC250_MODE      1
FADC250_NSB       12
FADC250_NSA       240
FADC250_NPEAK     1

#       channel:  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1

#Set RF clock threshold
FADC250_TET 800

FADC250_SLOT 13
FADC250_ALLCH_PED 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

FADC250_CRATE end


##########################
# HPS 12 Crate
##########################

### TI
TI_CRATE hps12
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end


##########################
# HPS 1 Crate
##########################

### TI
TI_CRATE hps1
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps1


FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 18

# Set LED system trigger threshold
FADC250_SLOT      20
FADC250_CH_TET    15   500

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_CRATE end

##########################
# HPS 2 Crate
##########################

### TI
TI_CRATE hps2
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps2


FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 18


# Set cosmic system trigger threshold
# 12bit -> 1V: 40 = ~10mV threshold
# relative to pedestal
FADC250_SLOT      20
FADC250_CH_TET    13   40
FADC250_CH_TET    14   40
#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0


FADC250_CRATE end


# include trigger/HPS/small/dsc2/hps11.cnf

#
# dsc2 config file for expid=clondev
#
# this file contains settings  for JLAB VME Discriminators DSC2
#
# CRATE      <tdcecal1>     <- crate name, usually IP name
#
# DSC2_SLOT  2   <- slot#
#
# DSC2_WIDTH  20  40   <- TDC width (ns), TRG width (ns)
#
# DSC2_TDCMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TDC enable mask
#
# DSC2_TRGMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TRG enable mask
#
# DSC2_TDCORMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TDC OR mask
#
# DSC2_TRGORMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TRG OR mask
#
# DSC2_THRESHOLD  20  50   <- board threshold: TDC threshold (mV), TRG threshold (mV)
#
# DSC2_CH_THRESHOLD    0  20   50   <- channel threshold: channel#, TDC threshold (mV), TRG threshold (mV)
#
#    following, if used, will supersede TRG width:
#
# DSC2_TRGDIGITAL   40  64    <- board digital TRG output: width (ns), delay (ns)
#
# DSC2_CH_TRGDIGITAL   0   40  64    <- channel digital TRG output: channel#, width (ns), delay (ns)
#
#
DSC2_CRATE     hps11

DSC2_SLOT       all

# DSC2_SCALER_REFPRESCALE=1250 => 100kHz Reference clock
DSC2_SCALER_REFPRESCALE 1250

# ECAL, MINIMIZE THRESHOLD (0=27mV):
DSC2_WIDTH       20  40
#DSC2_THRESHOLD   0  0
#DSC2_TRGDIGITAL 140  
#
# FOR NEUTRON COUTNERS:
DSC2_THRESHOLD   50  50


# RF SIGNAL, SLOT 20 CHANNELS 13/14:
DSC2_SLOT 20
DSC2_CH_THRESHOLD 13 400 500
DSC2_CH_THRESHOLD 14 400 500


# WHAT IS THIS (NOTHING IN SLOT2):
DSC2_SLOT       2
DSC2_CH_THRESHOLD    1  300   200

#
DSC2_CRATE     end

# include trigger/HPS/small/dsc2/hps12.cnf

#
# dsc2 config file for expid=clondev
#
# this file contains settings  for JLAB VME Discriminators DSC2
#
# CRATE      <tdcecal1>     <- crate name, usually IP name
#
# DSC2_SLOT  2   <- slot#
#
# DSC2_WIDTH  20  40   <- TDC width (ns), TRG width (ns)
#
# DSC2_TDCMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TDC enable mask
#
# DSC2_TRGMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TRG enable mask
#
# DSC2_TDCORMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TDC OR mask
#
# DSC2_TRGORMASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     <- TRG OR mask
#
# DSC2_THRESHOLD  20  50   <- board threshold: TDC threshold (mV), TRG threshold (mV)
#
# DSC2_CH_THRESHOLD    0  20   50   <- channel threshold: channel#, TDC threshold (mV), TRG threshold (mV)
#
#    following, if used, will supersede TRG width:
#
# DSC2_TRGDIGITAL   40  64    <- board digital TRG output: width (ns), delay (ns)
#
# DSC2_CH_TRGDIGITAL   0   40  64    <- channel digital TRG output: channel#, width (ns), delay (ns)
#
#
DSC2_CRATE     hps12

DSC2_SLOT       all

# DSC2_SCALER_REFPRESCALE=1250 => 100kHz Reference clock
DSC2_SCALER_REFPRESCALE 1250

# ECAL, MINIMIZE THERSHOLD (0=27mV):
DSC2_WIDTH       20  40
DSC2_THRESHOLD   0  0
#DSC2_TRGDIGITAL 140      0

# RF SIGNAL, SLOT 20 CHANNELS 13/14:
DSC2_SLOT 20
DSC2_CH_THRESHOLD 13 400 500
DSC2_CH_THRESHOLD 14 400 500

# WHAT IS THIS (NOTHING IN SLOT2)?
DSC2_SLOT       2
DSC2_CH_THRESHOLD    1  300   200



DSC2_CRATE     end

# ECAL PEDESTALS:

# include trigger/HPS/small/fadc250/peds/EcalPeds_200nA.trg

FADC250_CRATE  hps2
FADC250_DAC 3280
FADC250_SLOT  3
FADC250_ALLCH_PED  139.464 111.395  91.504 133.155 122.316  87.834 158.535 100.563 133.568 138.763 113.478 146.252 136.280 118.431 132.933 154.135
FADC250_SLOT  4
FADC250_ALLCH_PED  138.353 115.934 134.680 117.613 106.014 172.758 162.369 137.848 149.039 124.659 145.923 129.595 148.602 138.078 147.356 123.454
FADC250_SLOT  5
FADC250_ALLCH_PED   98.626  79.345  98.268 125.789 126.974 113.326 110.155 143.023 126.257 129.427 100.889 141.952 126.913 104.820 116.580 119.020
FADC250_SLOT  6
FADC250_ALLCH_PED   95.764 112.139 120.352 111.037 143.287 118.002  90.450  91.093 120.375 163.058 120.418 130.188  94.254 152.445 105.349 124.482
FADC250_SLOT  7
FADC250_ALLCH_PED  177.998 110.649 109.614 126.912 135.265 148.943 131.121 116.215 149.066 133.898 120.394 110.877 120.910 138.092 125.468 144.891
FADC250_SLOT  8
FADC250_ALLCH_PED  116.424 126.560  90.178  99.343 106.439  85.487 122.079 134.620  85.670 153.306 113.000  78.573 104.665  92.263  80.838  95.279
FADC250_SLOT  9
FADC250_ALLCH_PED  124.074 183.990 160.400 156.542 122.419 105.508 114.894 118.670 111.940 172.100 146.281 117.390 134.147 138.907 139.566 165.369
FADC250_SLOT  14
FADC250_ALLCH_PED  153.085 151.190 116.559 101.665 125.040 141.937 126.613 113.950 157.997 151.804 120.771 142.236 104.529 150.171  92.393 129.228
FADC250_SLOT  15
FADC250_ALLCH_PED   94.448 130.321  93.398  87.462 106.021 124.509 120.982 121.829 108.682 114.682 123.177  85.331 101.533 118.427 159.985  79.192
FADC250_SLOT  16
FADC250_ALLCH_PED  108.479 113.801  95.297  93.803 104.905 123.080 107.069 103.252 123.496  99.576 153.093 117.727 115.701 141.530  89.565  99.474
FADC250_SLOT  17
FADC250_ALLCH_PED  116.243 129.412 114.294 105.546 112.820 125.663 115.076 110.764 128.006 117.435 116.739 115.410 114.728 108.244 161.246 120.926
FADC250_SLOT  18
FADC250_ALLCH_PED  140.665 128.572 116.441 143.920 140.457 140.618 143.284 105.739 103.351 110.195 140.223 181.580 139.244 117.327 129.159 156.827
FADC250_SLOT  19
FADC250_ALLCH_PED  118.018 138.067 144.713 102.156  94.484 143.161  91.274  88.046  95.808 119.072 111.367  98.593 129.276 143.269 100.950 143.769
FADC250_SLOT  20
FADC250_ALLCH_PED  114.762 113.603 124.586 113.246  93.907 112.779 115.199  73.768 115.324 115.747  91.045  86.951 127.238 145.878 167.641 120.880
FADC250_CH_TET 13 3000
FADC250_CH_TET 14 3000
FADC250_CH_TET 15 3000
FADC250_CRATE end

# ECAL GAINS:

# include trigger/HPS/small/fadc250/gains/EcalGains.trg

FADC250_CRATE  hps2
FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.210   0.192   0.182   0.221   0.195   0.188   0.197   0.173   0.203   0.198   0.150   0.137   0.149   0.158   0.161   0.155
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.152   0.159   0.174   0.168   0.160   0.172   0.150   0.147   0.144   0.164   0.160   0.171   0.150   0.175   0.153   0.137
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.146   0.147   0.145   0.148   0.143   0.144   0.151   0.159   0.150   0.155   0.138   0.156   0.147   0.153   0.159   0.149
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.142   0.131   0.141   0.135   0.142   0.156   0.163   0.173   0.153   0.153   0.158   0.138   0.177   0.158   0.155   0.151
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.150   0.166   0.164   0.132   0.155   0.146   0.168   0.160   0.156   0.168   0.159   0.155   0.164   0.156   0.152   0.166
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.146   0.145   0.280   0.149   0.148   0.181   0.140   0.151   0.153   0.169   0.163   0.146   0.164   0.145   0.143   0.154
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.136   0.149   0.141   0.157   0.165   0.133   0.150   0.158   0.149   0.160   0.132   0.133   0.144   0.147   0.151   0.164
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.155   0.147   0.152   0.158   0.141   0.152   0.137   0.177   0.151   0.165   0.111   0.157   0.134   0.155   0.164   0.167
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.163   0.151   0.166   0.154   0.171   0.142   0.133   0.204   0.147   0.172   0.143   0.137   0.181   0.152   0.149   0.151
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.173   0.170   0.133   0.160   0.157   0.140   0.153   0.168   0.163   0.162   0.176   0.175   0.166   0.170   0.159   0.146
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.143   0.133   0.136   0.151   0.137   0.147   0.163   0.134   0.154   0.152   0.151   0.148   0.174   0.137   0.141   0.137
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.159   0.149   0.149   0.152   0.142   0.146   0.158   0.134   0.152   0.159   0.157   0.158   0.156   0.143   0.161   0.170
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.157   0.179   0.149   0.145   0.163   0.158   0.166   0.164   0.177   0.131   0.144   0.148   0.142   0.151   0.154   0.136
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.169   0.149   0.164   0.140   0.143   0.147   0.153   0.160   0.157   0.155   0.149   0.168   0.163   1.000   1.000   1.000
FADC250_CRATE end

